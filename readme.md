# Тестовое задание FastAPI

Сервер доступа по API к сервису getcourse.ru на фреймворке FastApi.

Маршруты:
- /users 
- /users/me
- /token
- /deals


## Запуск

- Клонируёте репозиторий
- Укжите параметры в файле `.env`(см. пункт Переменные окружения)
- Соберите образ командой
```
docker-compose build
```
- Запустите контейнеры командой
```
docker-compose up -d
```


## Переменные окружения

Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл `.env` в корневой папке и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.  За основу можно взять файл `env.example`, заменить значения переменных на свои и переименовать его в `.env`.
- `SECRET_TOKEN_KEY` - ключ шифрования токена
- `DATABASE_NAME` - имя БД
- `DB_USER` - имя пользователя БД
- `DB_PASSWORD` - пароль пользователя БД
- `DB_HOST` - сервер БД (для docker-compose совпадает с названием сервиса в котором поднимается БД)
- `DB_PORT` - порт БД

## Использование

Доступные endpoint'ы можно посмотреть в автодокументации http://127.0.0.1:8000/docs

- GET, POST http://127.0.0.1:8000/users не требует аутентификации, 
можно просмотреть существующих пользователей в БД и зарегестрировать нового.
Username должен совпадать с именем аккаунта getcourse.
Так же необходимо задать secret_key, полученный на getcourse, для доступа к его API.
- GET http://127.0.0.1:8000/users/me требует аутентификации, информация о текущем пользователе
- POST http://127.0.0.1:8000/token для аутентификации и получения токена
- GET http://127.0.0.1:8000/deals?status=new требует аутентификации, 
Возвращает список заказов с указанным статусом. 
Статус может принимать следующие значения - `new`, `payed`, `cancelled`, `in_work`, `payment_waiting`, `part_payed`, `waiting_for_return`, `not_confirmed`, `pending`
- POST http://127.0.0.1:8000/deals - требует аутентификации, необходимые поля:
  * `offer_code` или `product_title`
  * `deal_cost`
  * `user_email`
  
  `deal_id` необходимо указывать для обновления существующего заказа
  (см. https://getcourse.ru/help/api)